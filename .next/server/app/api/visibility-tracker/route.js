(()=>{var a={};a.id=289,a.ids=[289],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},45467:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>D,patchFetch:()=>C,routeModule:()=>y,serverHooks:()=>B,workAsyncStorage:()=>z,workUnitAsyncStorage:()=>A});var d={};c.r(d),c.d(d,{GET:()=>x,POST:()=>v});var e=c(96559),f=c(48088),g=c(37719),h=c(26191),i=c(81289),j=c(261),k=c(92603),l=c(39893),m=c(14823),n=c(47220),o=c(66946),p=c(47912),q=c(99786),r=c(46143),s=c(86439),t=c(43365),u=c(32190);async function v(a){try{var b;let{domain:c}=await a.json();if(!c)return u.NextResponse.json({error:"Domain is required"},{status:400});let d=c;d.startsWith("http://")||d.startsWith("https://")||(d="https://"+c);let e=null,f=0,g={};try{let a=await fetch(d,{headers:{"User-Agent":"Mozilla/5.0 (compatible; GEO-Tracker/1.0)"},signal:AbortSignal.timeout(1e4)});if(a.ok){let b=await a.text();e=function(a,b){var c,d,e,f;let g,h=(a.match(/\[\d+\]|<sup>.*?<\/sup>|<cite>.*?<\/cite>|References:|Bibliography:|Sources:/gi)||[]).length,i=(a.match(/\d+(\.\d+)?%|\d{1,3}(,\d{3})*(\.\d+)?|\$\d+|€\d+|£\d+/g)||[]).length,j=(a.match(/<h[1-6][^>]*>(.*?)<\/h[1-6]>/gi)||[]).length,k=/<(div|section)[^>]*(?:faq|qa|question).*?>(.*?)<\/\1>/gi.test(a),l=/<script[^>]*type=["']application\/ld\+json["'][^>]*>/gi.test(a),m=a.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim(),n=m.split(" ").filter(a=>a.length>2).length,o=h>3&&n>500,p=n>300&&j>2;return{citations:h,statistics:i,headings:j,wordCount:n,hasFAQ:k,hasSchema:l,authoritative:o,fluent:p,unique:m.includes(b)||m.toLowerCase().includes(b.toLowerCase()),contentQuality:(c=h,d=i,e=n,f=j,g=0,c>=5?g+=30:c>=3?g+=20:c>=1&&(g+=10),d>=10?g+=25:d>=5?g+=15:d>=2&&(g+=8),e>=1500?g+=20:e>=800?g+=12:e>=400&&(g+=6),f>=5?g+=15:f>=3?g+=10:f>=1&&(g+=5),Math.min(g,100))}}(b,c),f=function(a){if(!a)return 25;let b=25;return a.authoritative&&(b+=20),a.fluent&&(b+=15),a.citations>0&&(b+=Math.min(3*a.citations,20)),a.statistics>0&&(b+=Math.min(2*a.statistics,15)),a.hasFAQ&&(b+=10),a.hasSchema&&(b+=5),Math.min(b,100)}(e),g=function(a,b){let c=/<meta[^>]*name=["']description["'][^>]*content=["'](.*?)["']/i.test(a),d=(a.match(/<title[^>]*>(.*?)<\/title>/i)||["",""])[1],e=(a.match(/<h1[^>]*>(.*?)<\/h1>/gi)||[]).length,f=(a.match(/<h2[^>]*>(.*?)<\/h2>/gi)||[]).length,g=a.length;return{contentLength:g>1e4?"Comprehensive":g>5e3?"Moderate":"Brief",headings:`${e} H1, ${f} H2 tags`,hasSchema:/<script[^>]*type=["']application\/ld\+json["']/.test(a),hasMetaDescription:c,title:d.substring(0,60)}}(b,0)}}catch(a){console.log("Could not fetch website for analysis:",a)}let h=await w(c);(b=e)&&b.citations;let i={status:"real_analysis",message:"Based on real-time content analysis and GEO research findings",data:{domain:c,timestamp:new Date().toISOString(),analysisType:e?"full_analysis":"limited_analysis",geoScore:Math.round(f),contentMetrics:e||{citations:0,statistics:0,authoritative:!1,fluent:!1,unique:!1},platforms:function(a,b,c){let d=b&&b.contentQuality>50,e=b&&b.citations>3,f=b&&b.statistics>5;return[{platform:"Perplexity",icon:"\uD83D\uDD0D",visibility:e?65+Math.round(.2*a):30+Math.round(.3*a),trend:e?"up":"stable",trendPercent:e?12:3,analysis:e?"Strong citation presence detected - favorable for Perplexity":"Low citation count - add more authoritative sources"},{platform:"ChatGPT",icon:"\uD83E\uDD16",visibility:d?50+Math.round(.25*a):25+Math.round(.2*a),trend:b&&b.hasFAQ?"up":"stable",trendPercent:b&&b.hasFAQ?8:2,analysis:b&&b.hasFAQ?"FAQ content detected - good for conversational AI":"No FAQ sections found - consider adding Q&A content"},{platform:"Claude",icon:"\uD83E\uDDE0",visibility:f?45+Math.round(.2*a):20+Math.round(.25*a),trend:f?"up":"down",trendPercent:f?6:-2,analysis:f?"Good statistical content for technical queries":"Limited data points - add more statistics and facts"},{platform:"Bing Chat",icon:"\uD83D\uDCAC",visibility:c.hasSchema?40+Math.round(.15*a):20+Math.round(.1*a),trend:"stable",trendPercent:1,analysis:c.hasSchema?"Schema markup detected - helps with structured data":"No schema markup found - implement structured data"},{platform:"Gemini",icon:"✨",visibility:d?35+Math.round(.15*a):15+Math.round(.15*a),trend:"stable",trendPercent:0,analysis:"Google AI integration - focus on E-E-A-T signals"}]}(f,e,g),topQueries:function(a,b){let c=a.replace(/^(https?:\/\/)?(www\.)?/,"").split("/")[0],d=[];return b&&b.hasFAQ&&d.push({query:`how does ${c} work`,detected:!0,optimization:"FAQ content found - well optimized"}),b&&b.statistics>5&&d.push({query:`${c} statistics and data`,detected:!0,optimization:"Statistical content present"}),d.push({query:`what is ${c}`,detected:b&&b.wordCount>500,optimization:b&&b.wordCount>500?"Comprehensive content found":"Content too brief - expand explanations"}),d.push({query:`${c} vs alternatives`,detected:b&&b.contentQuality>60,optimization:"Consider adding comparison content"}),d}(c,e),recommendations:function(a,b){let c=[];return(!a||a.citations<3)&&c.push({priority:"high",title:"Add More Citations",description:`Currently ${a?a.citations:0} citations found. Add 3-5 authoritative sources per page.`,impact:"Expected +40% visibility on Perplexity (based on GEO research)",actionable:!0}),a&&a.hasFAQ||c.push({priority:"high",title:"Create FAQ Sections",description:"No FAQ content detected. Add Q&A sections for conversational AI optimization.",impact:"Expected +35% visibility on ChatGPT",actionable:!0}),(!a||a.statistics<5)&&c.push({priority:"medium",title:"Include More Statistics",description:`Only ${a?a.statistics:0} data points found. Add relevant statistics with sources.`,impact:"Expected +32% visibility improvement",actionable:!0}),a&&a.hasSchema||c.push({priority:"medium",title:"Implement Schema Markup",description:"No structured data detected. Add Article, FAQ, or HowTo schema.",impact:"Better AI comprehension and rich results",actionable:!0}),a&&a.wordCount<800&&c.push({priority:"low",title:"Expand Content Depth",description:`Current word count: ${a.wordCount}. Aim for 1500+ words for comprehensive coverage.`,impact:"Improved topical authority",actionable:!0}),c.slice(0,4)}(e,0),realInsights:{contentLength:g.contentLength||"Unable to analyze",headingStructure:g.headings||"Unable to analyze",schemaMarkup:g.hasSchema||!1,metaDescription:g.hasMetaDescription||!1,searchAppearance:h},nextSteps:function(a,b){let c=[];return b<40&&c.push("Critical: Your GEO score is low. Focus on citations and statistics first."),a?(a.citations<3&&c.push("Step 1: Add 3-5 authoritative citations to each main page"),a.hasFAQ||c.push("Step 2: Create FAQ sections targeting common questions"),a.statistics<5&&c.push("Step 3: Include relevant statistics and data points"),a.hasSchema||c.push("Step 4: Implement structured data markup")):c.push("Unable to analyze your website. Check if it's publicly accessible."),c.length>0?c:["Your content is well-optimized! Consider A/B testing different GEO strategies."]}(e,f)}};return u.NextResponse.json(i)}catch(a){return console.error("Visibility tracker error:",a),u.NextResponse.json({error:"Failed to track visibility",details:a instanceof Error?a.message:"Unknown error"},{status:500})}}async function w(a){let b=["google","facebook","amazon","microsoft","apple","wikipedia"].some(b=>a.includes(b));return{googleIndexed:b?"Yes":"Unknown",estimatedPages:b?"1000+":"Check Google Search Console",lastCrawled:"Requires API access"}}async function x(a){let{searchParams:b}=new URL(a.url),c=b.get("domain");return c?u.NextResponse.json({domain:c,isTracking:!1,lastChecked:null,message:"Domain not currently being tracked. Use POST to start tracking."}):u.NextResponse.json({error:"Domain parameter required"},{status:400})}let y=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/visibility-tracker/route",pathname:"/api/visibility-tracker",filename:"route",bundlePath:"app/api/visibility-tracker/route"},distDir:".next",projectDir:"",resolvedPagePath:"/Users/heni/GEO/app/api/visibility-tracker/route.ts",nextConfigOutput:"standalone",userland:d}),{workAsyncStorage:z,workUnitAsyncStorage:A,serverHooks:B}=y;function C(){return(0,g.patchFetch)({workAsyncStorage:z,workUnitAsyncStorage:A})}async function D(a,b,c){var d;let e="/api/visibility-tracker/route";"/index"===e&&(e="/");let g=await y.prepare(a,b,{srcPage:e,multiZoneDraftMode:"false"});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:z,routerServerContext:A,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,resolvedPathname:D}=g,E=(0,j.normalizeAppPath)(e),F=!!(z.dynamicRoutes[E]||z.routes[D]);if(F&&!x){let a=!!z.routes[D],b=z.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let G=null;!F||y.isDev||x||(G="/index"===(G=D)?"/":G);let H=!0===y.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:z,renderOpts:{experimental:{dynamicIO:!!w.experimental.dynamicIO,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>y.onRequestError(a,b,d,A)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>y.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&B&&C&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await y.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})},A),b}},l=await y.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:z,isRoutePPREnabled:!1,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",B?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&F||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(L||b instanceof s.NoFallbackError||await y.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})}),F)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},96487:()=>{}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[985,55],()=>b(b.s=45467));module.exports=c})();